<ion-header>
  <ion-toolbar color='dark'>
    <img src="assets/images/freseLogo.png" width="140px" height="90px" class="ion-margin"/>
    <div slot="end" class="ion-padding-end">
      <ion-button color="frese" (click)="openPopover($event)">
        <ion-icon slot="start" name="information-circle-outline"></ion-icon>
        About Us
      </ion-button>
    </div>
  </ion-toolbar>
</ion-header>
<ion-content color="light">
  <ion-grid>
    <ion-row class="full_size_row">
      <!--  Avaiable Items  -->
      <ion-col size="9">
        <ion-grid>
          <ion-row *ngFor="let type of this.productTypes">
            <ion-grid>
              <ion-row>
                <ion-title> {{ type.name }}</ion-title>
                <br>
              </ion-row>
              <ion-row>
                <div *ngFor="let item of getProductsForType(type)">
                  <ion-card class="item-row" *ngIf="item.typeId === type.id">
                    <ion-img class="item-image" *ngIf="item.photoUrl; else noPhoto" [src]="item.photoUrl"></ion-img>
                    <ng-template #noPhoto>
                      <ion-img class="item-image" src="assets/images/pizza.jpg"></ion-img>
                    </ng-template>
                    <ion-card-header>
                      <ion-card-title>{{item.title}}</ion-card-title>
                      <ion-card-subtitle *ngIf="item.price">${{item.price}}</ion-card-subtitle>
                      <ion-card-subtitle *ngIf="!item.price">See sizing for price</ion-card-subtitle>
                    </ion-card-header>
                    <ion-list *ngIf="hasAddOns(item)">
                      <div class="select-opt" *ngFor="let addOnKey of addOnKeys(item)">
                          <ion-select multiple=true [(ngModel)]="item.product_add_on_values[addOnKey].selected" (ngModelChange)="chooseAddOn(item, addOnKey, item.product_add_on_values[addOnKey])" [placeholder]="">

                          <ion-select-option *ngFor="let v of item.product_add_on_values[addOnKey]" [value]="v">
                            {{v.value}}
                            <br>
                            <p *ngIf="v.cost">${{v.cost}}</p>
                          </ion-select-option>
                        </ion-select>
                      </div>
                    </ion-list>
                    <ion-button color='frese' (click)="updateCart(item, ao, {})">Add to Cart</ion-button>
                  </ion-card>
                </div>
              </ion-row>
            </ion-grid>
          </ion-row>
        </ion-grid>
        <ng-template #loading>
          <ion-spinner name="lines"></ion-spinner>
        </ng-template>
      </ion-col>
      <!--  Cart  -->
      <ion-col class="float" size="3">
        <ion-toolbar class="cart">
          <ion-title>Cart</ion-title>
        </ion-toolbar>
        <ion-list>
          <ion-item-sliding *ngFor="let item of cart.items; let ii=index">
            <ion-item *ngIf="item">
              <ion-label>
                <ion-grid>
                  <ion-row>
                    <ion-col size="2">
                      <div>{{item.quantity}}</div>
                    </ion-col>
                    <ion-col>
                      <div>{{item.product_name}}</div>
                    </ion-col>
                    <ion-col>
                      <div class="endSlot">${{displayAmount(item.price * item.quantity)}}</div>
                    </ion-col>
                  </ion-row>
                </ion-grid>
<!--                <div class="endSlot">${{displayAmount(item.price * item.quantity)}}</div>-->
                <br>
                <div *ngFor="let selectionKey of getSelectionKeys(item)">
                  <div class="ninety">- {{selectionKey}}</div>
                  <div class="startSlot padded subText">
                    {{item.selections[selectionKey].value}}
                  </div>
                  <div class="endSlot">
                    <div *ngIf="item.selections[selectionKey].cost">${{displayAmount(item.selections[selectionKey].cost *
                      item.quantity)}}
                    </div>
                  </div>
                  <br>
                </div>
                <div *ngFor="let addOnKey of getAddOnKeys(item)">
                  <div class="ninety">- {{addOnKey}}</div>
                  <div *ngFor="let v of getAddOnValues(item, addOnKey)">
                    <div class="startSlot padded subText">
                      {{v.value}}
                    </div>
                    <div class="endSlot">
                      <div *ngIf="v.cost">${{displayAmount(v.cost * item.quantity)}}</div>
                    </div>
                  </div>
                </div>
              </ion-label>
            </ion-item>
            <ion-item-options side="end">
              <ion-button (click)="deleteItem(ii)">
                <ion-icon name="trash"></ion-icon>
              </ion-button>
            </ion-item-options>
          </ion-item-sliding>
        </ion-list>
      </ion-col>
        <div class="total">
          <div class="startSlot">
            <div class="subText">
            Subtotal: ${{displaySubtotal()}}<br>
            Est. Tax: ${{displayAmount(getTax(getSubtotal()))}}<br>
            </div>
            <b>Total:</b> ${{displayTotal()}}
          </div>
          <ion-button class="pay-button" (click)="Pay()">Checkout</ion-button>
        </div>
    </ion-row>
  </ion-grid>
</ion-content>
